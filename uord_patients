q#!/bin/bash
echo "Select your choice"
echo "1.Update a patient's full record"
echo "2.Delete patient's record"
read choice

if [[ "$choice" -eq 1 ]]
then
#Update code
patient_regex="[^a-zA-Z0-9 ]+"
number_regex="[^0-9 ]+"

echo "Please add the following patient details"

echo "Enter patient's id to edit"
read patient_id

echo "Enter new patient name"
read patient_name

if [[ "$patient_name" =~ $patient_regex ]]
then
echo "Please enter a valid name"
exit 1
fi

echo "Enter department where patient is admitted"
read department

if [[ "$department" =~ $department_regex ]]
then
echo "Please enter a valid department"
exit 1
fi

echo "Enter doctor's name for patient"
read doctor_name

if [[ "$doctor_name" =~ $doc_name_regex ]]
then
echo "Please enter a valid name"
exit 1
fi 
#Might have to do ask doctor_id and get doctor name from doctor table based on id
#Might have to do ask doctor_id and get doctor name from doctor table based on id
echo "Enter doc id"
read doctor_id

if [[ "$doctor_id" =~ $doc_id_regex ]]
then
echo "Please enter a valid doc id"
exit 1
fi


#UPDATE BUILDING

awk -F, -v patient_id="$patient_id" -v patient_name="$patient_name" -v department="$department" -v doctor_name="$doctor_name" -v doctor_id="$doctor_id" 'BEGIN {OFS=FS} {
   if($1 == patient_id) {
    $2=patient_name;
    $3=department;
    $4=doctor_name;
    $5=doctor_id;
    }
    }1' patients.csv > patients.tmp && mv patients.tmp patients.csv

echo "Patient's record updated!"
fi